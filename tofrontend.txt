Pantalla central: muestra productos y categorías; al clicar una categoría se filtran los productos; al clicar un producto se aumenta la cantidad del producto en el pedido activo (tab actual).

Lado derecho: sidebar de pedidos con múltiples tabs (cada tab = un pedido en curso). Los pedidos en curso se guardan en un store especial y pueden alternarse sin perder estado.

Cada pedido tiene línea de productos (order_detail), totales, descuentos, métodos de pago (app_payment máximo 1 por pedido; bank_payment múltiples), notas y comportamiento distinto según tipo de pedido: onsite, delivery, reservation.

Reglas de negocio clave: delivery obliga cliente+dirección; reservation obliga fecha/hora de entrega y se contabiliza en ventas del día de entrega (no de creación).

2 — Comportamiento UI detallado (pantalla principal + sidebar)
Layout

Main area (izquierda / centro)

Header: barra de búsqueda de producto.

Fila horizontal de categorías clickeables (chip/button). Al seleccionar una categoría: filtra automáticamente los productos mostrados. Indicación visual de la categoría activa.

Grid de productos (cada tarjeta con nombre, clic en tarjeta suma 1 al pedido actual).

Cada producto en la tarjeta muestra stock si aplica.

Sidebar (derecha) — estilo panel fijo (scroll si hay muchas tabs)

Tabs horizontales (o tipo pestaña vertical) — cada tab = pedido en curso.

Botón “+” para crear nuevo pedido (crea tab vacío con tipo por defecto delivery ).

Dentro de cada tab (pedido activo): se muestra el formulario del pedido (detalle abajo).

Interacciones importantes

Seleccionar categoría: aplica filtro inmediato sobre grid.

Clic en producto: si no existe en el pedido actual → crea order_detail con quantity=1; si existe → incrementa quantity. (En la UI mostrar animación/contador).

Botones + / − junto al producto en la lista del pedido: aumentan/disminuyen cantidad (si cantidad llega a 0 quitar inmediatamente según UX).

Tabs: cambiar de tab guarda estado automáticamente. Cerrar tab pregunta: “Guardar/Descartar/Cancelar”.

Persistencia temporal: todos los pedidos en curso se guardan en store.



Reglas por tipo

Onsite: cliente opcional; también permitir “nombre de espera” (campo guest_name) si no se registra cliente. Puede aplicarse fidelización si se asigna cliente. (Seguir la regla de la especificación: onsite puede no tener cliente).

Delivery: cliente obligatorio. En la UI: buscador por teléfono; si no existe → botón para crear cliente + dirección; si existe → seleccionar cliente y seleccionar direcciones guardadas (si alguna marcada como principal → seleccionar por defecto). En el selector de direcciones incluir opción “Crear nueva dirección”. El delivery_fee por defecto es el de la dirección seleccionada (pero editable).

Reservation: mismos campos que un pedido normal más reserved_for (fecha+hora) obligatorio. A tener en cuenta contable/estados: estos pedidos sumarán en las ventas del día reserved_for, no del created_at. (Regla del negocio).

4 — Reglas de pagos

app_payment: solo 1 por pedido. Debe existir registro en tabla app_payment cuando se seleccione. Backend valida que no existan >1 app_payment por order_id.

bank_payment: pueden existir múltiples bank_payment por order_id. Se guardan en su tabla.

Validación: la suma de app_payment.amount + sum(bank_payments.amount) ≤ total; si es menor puede quedar como saldo pendiente o abono parcial dependiendo del flujo que quieras (definir comportamiento: permitir abonos o exigir pago completo).



 Componentes sugeridos (nombres y responsabilidades)

ProductsGrid.vue — muestra cards de productos, maneja click -> store.addProductToActive.

CategoriesBar.vue — botones/filters que emiten categoría seleccionada.

OrderSidebar.vue — wrapper de tabs y control de tabs.

OrderTab.vue — contenido del pedido: CustomerSelector, AddressSelector, OrderLines, TotalsPanel, PaymentSelector, Notes, Save/Send.

CustomerSelector.vue — buscador por teléfono + crear cliente modal.

AddressSelector.vue — lista de direcciones del cliente + opción crear nueva + marca de dirección principal.

PaymentSelector.vue — elegir app (dropdown) y bancos (multi row), muestra validaciones (1 app max).